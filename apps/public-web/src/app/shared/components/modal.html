<!-- Modal Backdrop -->
@if (isOpen) {
<div
  class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50"
  [@backdropAnimation]="animationState()"
  (click)="onBackdropClick($event)"
  role="dialog"
  [attr.aria-modal]="true"
  [attr.aria-label]="ariaLabel || title || 'Modal'"
  [attr.aria-describedby]="ariaDescribedBy"
>
  <!-- Modal Container -->
  <div
    #modalContent
    class="relative w-full bg-white rounded-lg shadow-xl overflow-hidden"
    [ngClass]="[modalSizeClass(), customClass]"
    [@modalAnimation]="animationState()"
    (click)="$event.stopPropagation()"
  >
    <!-- Modal Header -->
    @if (title || showCloseButton) {
    <div class="flex items-center justify-between px-6 py-4 border-b border-gray-200">
      @if (title) {
      <h2 class="text-xl font-semibold text-gray-900" id="modal-title">
        {{ title }}
      </h2>
      } @if (showCloseButton) {
      <button
        #closeButton
        type="button"
        class="text-gray-400 hover:text-gray-600 transition-colors focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 rounded-lg p-1"
        (click)="close()"
        aria-label="Close modal"
      >
        <svg
          class="w-6 h-6"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M6 18L18 6M6 6l12 12"
          ></path>
        </svg>
      </button>
      }
    </div>
    }

    <!-- Modal Body -->
    <div class="px-6 py-4" [ngClass]="contentClass">
      <!-- Content projection for custom templates -->
      <ng-content></ng-content>

      <!-- Simple text content if no projection -->
      @if (content && !hasProjectedContent()) {
      <p class="text-gray-700">
        {{ content }}
      </p>
      }
    </div>

    <!-- Modal Footer -->
    @if (displayButtons.length > 0) {
    <div class="flex items-center justify-end gap-3 px-6 py-4 border-t border-gray-200 bg-gray-50">
      @for (button of displayButtons; track button.label) {
      <button
        type="button"
        [ngClass]="getButtonClass(button)"
        [disabled]="button.disabled"
        (click)="onButtonClick(button)"
      >
        {{ button.label }}
      </button>
      }
    </div>
    }
  </div>
</div>
}
